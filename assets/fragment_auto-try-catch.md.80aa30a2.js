import{_ as a,o as l,c as p,a as n,b as s}from"./app.f983686f.js";const d=JSON.parse('{"title":"å¦‚ä½•ç»™æ‰€æœ‰çš„ async å‡½æ•°æ·»åŠ  try/catchï¼Ÿ","description":"","frontmatter":{},"headers":[{"level":2,"title":"å‰è¨€","slug":"å‰è¨€","link":"#å‰è¨€","children":[]},{"level":2,"title":"async å¦‚æœä¸åŠ  try/catch ä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿ","slug":"async-å¦‚æœä¸åŠ -try-catch-ä¼šå‘ç”Ÿä»€ä¹ˆäº‹","link":"#async-å¦‚æœä¸åŠ -try-catch-ä¼šå‘ç”Ÿä»€ä¹ˆäº‹","children":[]},{"level":2,"title":"babel æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ","slug":"babel-æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ","link":"#babel-æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ","children":[]},{"level":2,"title":"babel æ’ä»¶çš„å®ç°æ€è·¯","slug":"babel-æ’ä»¶çš„å®ç°æ€è·¯","link":"#babel-æ’ä»¶çš„å®ç°æ€è·¯","children":[]},{"level":2,"title":"babel çš„æ ¸å¿ƒï¼šAST","slug":"babel-çš„æ ¸å¿ƒ-ast","link":"#babel-çš„æ ¸å¿ƒ-ast","children":[]},{"level":2,"title":"å¸¸ç”¨çš„ AST èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨","slug":"å¸¸ç”¨çš„-ast-èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨","link":"#å¸¸ç”¨çš„-ast-èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨","children":[]},{"level":2,"title":"await èŠ‚ç‚¹å¯¹åº”çš„ AST ç»“æ„","slug":"await-èŠ‚ç‚¹å¯¹åº”çš„-ast-ç»“æ„","link":"#await-èŠ‚ç‚¹å¯¹åº”çš„-ast-ç»“æ„","children":[]},{"level":2,"title":"babel æ’ä»¶å¼€å‘","slug":"babel-æ’ä»¶å¼€å‘","link":"#babel-æ’ä»¶å¼€å‘","children":[{"level":3,"title":"æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹","slug":"æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹","link":"#æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹","children":[]},{"level":3,"title":"å¯»æ‰¾ await èŠ‚ç‚¹","slug":"å¯»æ‰¾-await-èŠ‚ç‚¹","link":"#å¯»æ‰¾-await-èŠ‚ç‚¹","children":[]},{"level":3,"title":"å‘ä¸ŠæŸ¥æ‰¾ async å‡½æ•°","slug":"å‘ä¸ŠæŸ¥æ‰¾-async-å‡½æ•°","link":"#å‘ä¸ŠæŸ¥æ‰¾-async-å‡½æ•°","children":[]},{"level":3,"title":"åˆ©ç”¨ babel-template ç”Ÿæˆ try/catch èŠ‚ç‚¹","slug":"åˆ©ç”¨-babel-template-ç”Ÿæˆ-try-catch-èŠ‚ç‚¹","link":"#åˆ©ç”¨-babel-template-ç”Ÿæˆ-try-catch-èŠ‚ç‚¹","children":[]},{"level":3,"title":"async å‡½æ•°ä½“æ›¿æ¢æˆ try è¯­å¥","slug":"async-å‡½æ•°ä½“æ›¿æ¢æˆ-try-è¯­å¥","link":"#async-å‡½æ•°ä½“æ›¿æ¢æˆ-try-è¯­å¥","children":[]},{"level":3,"title":"è‹¥å‡½æ•°å·²å­˜åœ¨ try/catchï¼Œåˆ™ä¸å¤„ç†","slug":"è‹¥å‡½æ•°å·²å­˜åœ¨-try-catch-åˆ™ä¸å¤„ç†","link":"#è‹¥å‡½æ•°å·²å­˜åœ¨-try-catch-åˆ™ä¸å¤„ç†","children":[]},{"level":3,"title":"æ·»åŠ æŠ¥é”™ä¿¡æ¯","slug":"æ·»åŠ æŠ¥é”™ä¿¡æ¯","link":"#æ·»åŠ æŠ¥é”™ä¿¡æ¯","children":[]},{"level":3,"title":"æ·»åŠ ç”¨æˆ·é€‰é¡¹","slug":"æ·»åŠ ç”¨æˆ·é€‰é¡¹","link":"#æ·»åŠ ç”¨æˆ·é€‰é¡¹","children":[]},{"level":3,"title":"æœ€ç»ˆä»£ç ","slug":"æœ€ç»ˆä»£ç ","link":"#æœ€ç»ˆä»£ç ","children":[]}]}],"relativePath":"fragment/auto-try-catch.md","lastUpdated":1713238328000}'),o={name:"fragment/auto-try-catch.md"},e=n(`<h1 id="å¦‚ä½•ç»™æ‰€æœ‰çš„-async-å‡½æ•°æ·»åŠ -try-catch" tabindex="-1">å¦‚ä½•ç»™æ‰€æœ‰çš„ async å‡½æ•°æ·»åŠ  try/catchï¼Ÿ <a class="header-anchor" href="#å¦‚ä½•ç»™æ‰€æœ‰çš„-async-å‡½æ•°æ·»åŠ -try-catch" aria-hidden="true">#</a></h1><h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a></h2><p>é˜¿é‡Œä¸‰é¢çš„æ—¶å€™è¢«é—®åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶æ€è·¯è™½ç„¶æ­£ç¡®ï¼Œå¯æƒœè¡¨è¿°çš„ä¸å¤Ÿæ¸…æ™°</p><p>åæ¥èŠ±äº†ä¸€äº›æ—¶é—´æ•´ç†äº†ä¸‹æ€è·¯ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°ç»™æ‰€æœ‰çš„ async å‡½æ•°æ·»åŠ  try/catch å‘¢ï¼Ÿ</p><h2 id="async-å¦‚æœä¸åŠ -try-catch-ä¼šå‘ç”Ÿä»€ä¹ˆäº‹" tabindex="-1">async å¦‚æœä¸åŠ  try/catch ä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿ <a class="header-anchor" href="#async-å¦‚æœä¸åŠ -try-catch-ä¼šå‘ç”Ÿä»€ä¹ˆäº‹" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;failure&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  });</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;do something...&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> value </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    reject(</span><span style="color:#FFAB70;">&quot;failure&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  });</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;do something...&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#B392F0;">fn();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å¯¼è‡´æµè§ˆå™¨æŠ¥é”™ï¼šä¸€ä¸ªæœªæ•è·çš„é”™è¯¯</p><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿå¥å£®æ€§ï¼Œæˆ–è€…æ˜¯ä¸ºäº†æ•è·å¼‚æ­¥çš„é”™è¯¯ï¼Œéœ€è¦é¢‘ç¹çš„åœ¨ async å‡½æ•°ä¸­æ·»åŠ  try/catchï¼Œé¿å…å‡ºç°ä¸Šè¿°ç¤ºä¾‹çš„æƒ…å†µ</p><p>å¯æ˜¯æˆ‘å¾ˆæ‡’ï¼Œä¸æƒ³ä¸€ä¸ªä¸ªåŠ ï¼Œ<code>æ‡’æƒ°ä½¿æˆ‘ä»¬è¿›æ­¥</code>ğŸ˜‚</p><p>ä¸‹é¢ï¼Œé€šè¿‡æ‰‹å†™ä¸€ä¸ª babel æ’ä»¶ï¼Œæ¥ç»™æ‰€æœ‰çš„ async å‡½æ•°æ·»åŠ  try/catch</p><h2 id="babel-æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ" tabindex="-1">babel æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ <a class="header-anchor" href="#babel-æ’ä»¶çš„æœ€ç»ˆæ•ˆæœ" aria-hidden="true">#</a></h2><p>åŸå§‹ä»£ç ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¥é”™&quot;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;do something...&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> reject(</span><span style="color:#FFAB70;">&quot;æŠ¥é”™&quot;</span><span style="color:#B392F0;">));</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> resolve(</span><span style="color:#F8F8F8;">1</span><span style="color:#B392F0;">));</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;do something...&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#B392F0;">fn();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä½¿ç”¨æ’ä»¶è½¬åŒ–åçš„ä»£ç ï¼š</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">reject</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">reject</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;æŠ¥é”™&quot;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Promise</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">resolve</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;do something...&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">filePath: E:</span><span style="color:#56B6C2;">\\\\</span><span style="color:#98C379;">myapp</span><span style="color:#56B6C2;">\\\\</span><span style="color:#98C379;">src</span><span style="color:#56B6C2;">\\\\</span><span style="color:#98C379;">main.js</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">funcName: fn</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">Error:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">try</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> reject) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> reject(</span><span style="color:#FFAB70;">&quot;æŠ¥é”™&quot;</span><span style="color:#B392F0;">));</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#B392F0;">((resolve) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> resolve(</span><span style="color:#F8F8F8;">1</span><span style="color:#B392F0;">));</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;do something...&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">  } </span><span style="color:#F97583;">catch</span><span style="color:#B392F0;"> (e) {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(</span><span style="color:#FFAB70;">&quot;\\nfilePath: E:\\\\myapp\\\\src\\\\main.js\\nfuncName: fn\\nError:&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> e);</span></span>
<span class="line"><span style="color:#B392F0;">  }</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#B392F0;">fn();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>é€šè¿‡è¯¦ç»†çš„æŠ¥é”™ä¿¡æ¯ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°ç›®æ ‡æ–‡ä»¶å’Œå…·ä½“çš„æŠ¥é”™æ–¹æ³•ï¼Œæ–¹ä¾¿å»å®šä½é—®é¢˜</p><h2 id="babel-æ’ä»¶çš„å®ç°æ€è·¯" tabindex="-1">babel æ’ä»¶çš„å®ç°æ€è·¯ <a class="header-anchor" href="#babel-æ’ä»¶çš„å®ç°æ€è·¯" aria-hidden="true">#</a></h2><p>1ï¼‰å€ŸåŠ© AST æŠ½è±¡è¯­æ³•æ ‘ï¼Œéå†æŸ¥æ‰¾ä»£ç ä¸­çš„ await å…³é”®å­—</p><p>2ï¼‰æ‰¾åˆ° await èŠ‚ç‚¹åï¼Œä»çˆ¶è·¯å¾„ä¸­æŸ¥æ‰¾å£°æ˜çš„ async å‡½æ•°ï¼Œè·å–è¯¥å‡½æ•°çš„ bodyï¼ˆå‡½æ•°ä¸­åŒ…å«çš„ä»£ç ï¼‰</p><p>3ï¼‰åˆ›å»º try/catch è¯­å¥ï¼Œå°†åŸæ¥ async çš„ body æ”¾å…¥å…¶ä¸­</p><p>4ï¼‰æœ€åå°† async çš„ body æ›¿æ¢æˆåˆ›å»ºçš„ try/catch è¯­å¥</p><h2 id="babel-çš„æ ¸å¿ƒ-ast" tabindex="-1">babel çš„æ ¸å¿ƒï¼šAST <a class="header-anchor" href="#babel-çš„æ ¸å¿ƒ-ast" aria-hidden="true">#</a></h2><p>å…ˆèŠèŠ AST è¿™ä¸ªå¸…å°ä¼™ ğŸ¤ ï¼Œä¸ç„¶åé¢çš„å¼€å‘æµç¨‹èµ°ä¸ä¸‹å»</p><p>AST æ˜¯ä»£ç çš„æ ‘å½¢ç»“æ„ï¼Œç”Ÿæˆ AST åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š<a href="https://en.wikipedia.org/wiki/Lexical_analysis" target="_blank" rel="noreferrer"><strong>è¯æ³•åˆ†æ</strong></a>å’Œ Â <a href="https://en.wikipedia.org/wiki/Parsing" target="_blank" rel="noreferrer"><strong>è¯­æ³•åˆ†æ</strong></a></p><p><strong>è¯æ³•åˆ†æ</strong></p><p>è¯æ³•åˆ†æé˜¶æ®µæŠŠå­—ç¬¦ä¸²å½¢å¼çš„ä»£ç è½¬æ¢ä¸º<strong>ä»¤ç‰Œï¼ˆtokensï¼‰</strong> ï¼Œå¯ä»¥æŠŠ tokens çœ‹ä½œæ˜¯ä¸€ä¸ªæ‰å¹³çš„è¯­æ³•ç‰‡æ®µæ•°ç»„ï¼Œæè¿°äº†ä»£ç ç‰‡æ®µåœ¨æ•´ä¸ªä»£ç ä¸­çš„ä½ç½®å’Œè®°å½•å½“å‰å€¼çš„ä¸€äº›ä¿¡æ¯</p><p><strong>è¯­æ³•åˆ†æ</strong></p><p>è¯­æ³•åˆ†æé˜¶æ®µä¼šæŠŠ token è½¬æ¢æˆ AST çš„å½¢å¼ï¼Œè¿™ä¸ªé˜¶æ®µä¼šä½¿ç”¨ token ä¸­çš„ä¿¡æ¯æŠŠå®ƒä»¬è½¬æ¢æˆä¸€ä¸ª AST çš„è¡¨è¿°ç»“æ„ï¼Œä½¿ç”¨ type å±æ€§è®°å½•å½“å‰çš„ç±»å‹</p><p>ä¾‹å¦‚ let ä»£è¡¨ç€ä¸€ä¸ªå˜é‡å£°æ˜çš„å…³é”®å­—ï¼Œæ‰€ä»¥å®ƒçš„ type ä¸º <code>VariableDeclaration</code>ï¼Œè€Œ a = 1 ä¼šä½œä¸º let çš„å£°æ˜æè¿°ï¼Œå®ƒçš„ type ä¸º <code>VariableDeclarator</code></p><p>AST åœ¨çº¿æŸ¥çœ‹å·¥å…·ï¼š<a href="https://astexplorer.net/" target="_blank" rel="noreferrer"><strong>AST explorer</strong></a></p><p><strong>å†ä¸¾ä¸ª ğŸŒ°ï¼ŒåŠ æ·±å¯¹ AST çš„ç†è§£</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">demo</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">n</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">n</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">n</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> demo(n) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> n </span><span style="color:#F97583;">*</span><span style="color:#B392F0;"> n;</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è½¬åŒ–æˆ AST çš„ç»“æ„</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Program&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// æ•´æ®µä»£ç çš„ä¸»ä½“</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;body&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;FunctionDeclaration&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// function çš„ç±»å‹å«å‡½æ•°å£°æ˜ï¼›</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#ABB2BF;">: { </span><span style="color:#7F848E;font-style:italic;">// id ä¸ºå‡½æ•°å£°æ˜çš„ id</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Identifier&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// æ ‡è¯†ç¬¦ ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;demo&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">// æ ‡è¯†ç¬¦ å…·æœ‰åå­—</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;expression&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;generator&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;async&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// ä»£è¡¨æ˜¯å¦ æ˜¯ async function</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;params&quot;</span><span style="color:#ABB2BF;">: [ </span><span style="color:#7F848E;font-style:italic;">// åŒçº§ å‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Identifier&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">// å‚æ•°ç±»å‹ä¹Ÿæ˜¯ Identifier</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#98C379;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">      ],</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#98C379;">&quot;body&quot;</span><span style="color:#ABB2BF;">: { </span><span style="color:#7F848E;font-style:italic;">// å‡½æ•°ä½“å†…å®¹ æ•´ä¸ªæ ¼å¼å‘ˆç°ä¸€ç§æ ‘çš„æ ¼å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;BlockStatement&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// æ•´ä¸ªå‡½æ•°ä½“å†…å®¹ ä¸ºä¸€ä¸ªå—çŠ¶ä»£ç å—ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;body&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">          {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ReturnStatement&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// return ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;argument&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;BinaryExpression&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">// BinaryExpression äºŒè¿›åˆ¶è¡¨è¾¾å¼ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;start&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;end&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">35</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;left&quot;</span><span style="color:#ABB2BF;">: { </span><span style="color:#7F848E;font-style:italic;">// åˆ†å·¦ å³ ä¸­ ç»“æ„</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Identifier&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">              },</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;operator&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;*&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// å±äºæ“ä½œç¬¦</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#98C379;">&quot;right&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;type&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Identifier&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">              }</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">          }</span></span>
<span class="line"><span style="color:#ABB2BF;">        ]</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  ],</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#98C379;">&quot;sourceType&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;module&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#B392F0;">{</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#B392F0;">: </span><span style="color:#FFAB70;">&quot;Program&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// æ•´æ®µä»£ç çš„ä¸»ä½“</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#FFAB70;">&quot;body&quot;</span><span style="color:#B392F0;">: [</span></span>
<span class="line"><span style="color:#B392F0;">    {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FunctionDeclaration&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// function çš„ç±»å‹å«å‡½æ•°å£°æ˜ï¼›</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;id&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { </span><span style="color:#6B737C;">// id ä¸ºå‡½æ•°å£°æ˜çš„ id</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Identifier&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// æ ‡è¯†ç¬¦ ç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#FFAB70;">&quot;name&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;demo&quot;</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// æ ‡è¯†ç¬¦ å…·æœ‰åå­—</span></span>
<span class="line"><span style="color:#B392F0;">      }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;expression&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;generator&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;async&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// ä»£è¡¨æ˜¯å¦ æ˜¯ async function</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;params&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> [ </span><span style="color:#6B737C;">// åŒçº§ å‡½æ•°çš„å‚æ•°</span></span>
<span class="line"><span style="color:#B392F0;">        {</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Identifier&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#6B737C;">// å‚æ•°ç±»å‹ä¹Ÿæ˜¯ Identifier</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#FFAB70;">&quot;name&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#B392F0;">        }</span></span>
<span class="line"><span style="color:#B392F0;">      ]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#FFAB70;">&quot;body&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { </span><span style="color:#6B737C;">// å‡½æ•°ä½“å†…å®¹ æ•´ä¸ªæ ¼å¼å‘ˆç°ä¸€ç§æ ‘çš„æ ¼å¼</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;BlockStatement&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// æ•´ä¸ªå‡½æ•°ä½“å†…å®¹ ä¸ºä¸€ä¸ªå—çŠ¶ä»£ç å—ç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#FFAB70;">&quot;body&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> [</span></span>
<span class="line"><span style="color:#B392F0;">          {</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;ReturnStatement&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// return ç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#FFAB70;">&quot;argument&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;BinaryExpression&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#6B737C;">// BinaryExpression äºŒè¿›åˆ¶è¡¨è¾¾å¼ç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;start&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">30</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;end&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#F8F8F8;">35</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;left&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> { </span><span style="color:#6B737C;">// åˆ†å·¦ å³ ä¸­ ç»“æ„</span></span>
<span class="line"><span style="color:#B392F0;">                </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Identifier&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">                </span><span style="color:#FFAB70;">&quot;name&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#B392F0;">              }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;operator&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;*&quot;</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#6B737C;">// å±äºæ“ä½œç¬¦</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#FFAB70;">&quot;right&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">                </span><span style="color:#FFAB70;">&quot;type&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Identifier&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">                </span><span style="color:#FFAB70;">&quot;name&quot;</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;n&quot;</span></span>
<span class="line"><span style="color:#B392F0;">              }</span></span>
<span class="line"><span style="color:#B392F0;">            }</span></span>
<span class="line"><span style="color:#B392F0;">          }</span></span>
<span class="line"><span style="color:#B392F0;">        ]</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"><span style="color:#B392F0;">    }</span></span>
<span class="line"><span style="color:#B392F0;">  ]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#FFAB70;">&quot;sourceType&quot;</span><span style="color:#B392F0;">: </span><span style="color:#FFAB70;">&quot;module&quot;</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="å¸¸ç”¨çš„-ast-èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨" tabindex="-1">å¸¸ç”¨çš„ AST èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨ <a class="header-anchor" href="#å¸¸ç”¨çš„-ast-èŠ‚ç‚¹ç±»å‹å¯¹ç…§è¡¨" aria-hidden="true">#</a></h2>`,35),c=s("table",null,[s("thead",null,[s("tr",null,[s("th",null,"ç±»å‹åŸåç§°"),s("th",null,"ä¸­æ–‡åç§°"),s("th",null,"æè¿°")])]),s("tbody",null,[s("tr",null,[s("td",null,"Program"),s("td",null,"ç¨‹åºä¸»ä½“"),s("td",null,"æ•´æ®µä»£ç çš„ä¸»ä½“")]),s("tr",null,[s("td",null,"VariableDeclaration"),s("td",null,"å˜é‡å£°æ˜"),s("td",null,"å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œä¾‹å¦‚ var let const")]),s("tr",null,[s("td",null,[s("code",null,"FunctionDeclaration")]),s("td",null,"å‡½æ•°å£°æ˜"),s("td",null,"å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ function")]),s("tr",null,[s("td",null,"ExpressionStatement"),s("td",null,"è¡¨è¾¾å¼è¯­å¥"),s("td",null,"é€šå¸¸æ˜¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ console.log()")]),s("tr",{var:"",a:""},[s("td",null,"BlockStatement"),s("td",null,"å—è¯­å¥"),s("td",null,"åŒ…è£¹åœ¨ {} å—å†…çš„ä»£ç ï¼Œä¾‹å¦‚ if (condition)")]),s("tr",null,[s("td",null,"BreakStatement"),s("td",null,"ä¸­æ–­è¯­å¥"),s("td",null,"é€šå¸¸æŒ‡ break")]),s("tr",null,[s("td",null,"ContinueStatement"),s("td",null,"æŒç»­è¯­å¥"),s("td",null,"é€šå¸¸æŒ‡ continue")]),s("tr",null,[s("td",null,"ReturnStatement"),s("td",null,"è¿”å›è¯­å¥"),s("td",null,"é€šå¸¸æŒ‡ return")]),s("tr",null,[s("td",null,"SwitchStatement"),s("td",null,"Switch è¯­å¥"),s("td",null,"é€šå¸¸æŒ‡ Switch Case è¯­å¥ä¸­çš„ Switch")]),s("tr",null,[s("td",null,"IfStatement"),s("td",null,"If æ§åˆ¶æµè¯­å¥"),s("td",null,"æ§åˆ¶æµè¯­å¥ï¼Œé€šå¸¸æŒ‡ if(condition){}else{}")]),s("tr",null,[s("td",null,"Identifier"),s("td",null,"æ ‡è¯†ç¬¦"),s("td",null,"æ ‡è¯†ï¼Œä¾‹å¦‚å£°æ˜å˜é‡æ—¶ var identi = 5 ä¸­çš„ identi")]),s("tr",null,[s("td",null,"CallExpression"),s("td",null,"è°ƒç”¨è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ console.log()")]),s("tr",null,[s("td",null,"BinaryExpression"),s("td",null,"äºŒè¿›åˆ¶è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡è¿ç®—ï¼Œä¾‹å¦‚ 1+2")]),s("tr",null,[s("td",null,"MemberExpression"),s("td",null,"æˆå‘˜è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡è°ƒç”¨å¯¹è±¡çš„æˆå‘˜ï¼Œä¾‹å¦‚ console å¯¹è±¡çš„ log æˆå‘˜")]),s("tr",null,[s("td",null,"ArrayExpression"),s("td",null,"æ•°ç»„è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡ä¸€ä¸ªæ•°ç»„ï¼Œä¾‹å¦‚ [1, 3, 5]")]),s("tr",null,[s("td",null,[s("code",null,"FunctionExpression")]),s("td",null,"å‡½æ•°è¡¨è¾¾å¼"),s("td",null,"ä¾‹å¦‚ const func = function () {}")]),s("tr",null,[s("td",null,[s("code",null,"ArrowFunctionExpression")]),s("td",null,"ç®­å¤´å‡½æ•°è¡¨è¾¾å¼"),s("td",null,"ä¾‹å¦‚ const func = ()=> {}")]),s("tr",null,[s("td",null,[s("code",null,"AwaitExpression")]),s("td",null,"await è¡¨è¾¾å¼"),s("td",null,"ä¾‹å¦‚ let val = await f()")]),s("tr",null,[s("td",null,[s("code",null,"ObjectMethod")]),s("td",null,"å¯¹è±¡ä¸­å®šä¹‰çš„æ–¹æ³•"),s("td",null,"ä¾‹å¦‚ let obj = { fn ()")]),s("tr",null,[s("td",null,"NewExpression"),s("td",null,"New è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡ä½¿ç”¨ New å…³é”®è¯")]),s("tr",null,[s("td",null,"AssignmentExpression"),s("td",null,"èµ‹å€¼è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡å°†å‡½æ•°çš„è¿”å›å€¼èµ‹å€¼ç»™å˜é‡")]),s("tr",null,[s("td",null,"UpdateExpression"),s("td",null,"æ›´æ–°è¡¨è¾¾å¼"),s("td",null,"é€šå¸¸æŒ‡æ›´æ–°æˆå‘˜å€¼ï¼Œä¾‹å¦‚ i++")]),s("tr",null,[s("td",null,"Literal"),s("td",null,"å­—é¢é‡"),s("td",null,"å­—é¢é‡")]),s("tr",null,[s("td",null,"BooleanLiteral"),s("td",null,"å¸ƒå°”å‹å­—é¢é‡"),s("td",null,"å¸ƒå°”å€¼ï¼Œä¾‹å¦‚ true false")]),s("tr",null,[s("td",null,"NumericLiteral"),s("td",null,"æ•°å­—å‹å­—é¢é‡"),s("td",null,"æ•°å­—ï¼Œä¾‹å¦‚ 100")]),s("tr",null,[s("td",null,"StringLiteral"),s("td",null,"å­—ç¬¦å‹å­—é¢é‡"),s("td",null,"å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ vansenb")]),s("tr",null,[s("td",null,"SwitchCase"),s("td",null,"Case è¯­å¥"),s("td",null,"é€šå¸¸æŒ‡ Switch è¯­å¥ä¸­çš„ Case")])])],-1),t=n(`<h2 id="await-èŠ‚ç‚¹å¯¹åº”çš„-ast-ç»“æ„" tabindex="-1">await èŠ‚ç‚¹å¯¹åº”çš„ AST ç»“æ„ <a class="header-anchor" href="#await-èŠ‚ç‚¹å¯¹åº”çš„-ast-ç»“æ„" aria-hidden="true">#</a></h2><p>1ï¼‰åŸå§‹ä»£ç </p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2ï¼‰å¢åŠ  try catch åçš„ä»£ç </p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">try</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">  } </span><span style="color:#F97583;">catch</span><span style="color:#B392F0;"> (e) {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(e);</span></span>
<span class="line"><span style="color:#B392F0;">  }</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>é€šè¿‡ AST ç»“æ„å¯¹æ¯”ï¼Œæ’ä»¶çš„æ ¸å¿ƒå°±æ˜¯å°†åŸå§‹å‡½æ•°çš„ body æ”¾åˆ° try è¯­å¥ä¸­</strong></p><h2 id="babel-æ’ä»¶å¼€å‘" tabindex="-1">babel æ’ä»¶å¼€å‘ <a class="header-anchor" href="#babel-æ’ä»¶å¼€å‘" aria-hidden="true">#</a></h2><p>ä½œè€…æ›¾åœ¨<a href="https://juejin.cn/post/7146976516692410376#heading-34" target="_blank" rel="noreferrer">ã€Šã€Œå†æ—¶ 8 ä¸ªæœˆã€10 ä¸‡å­—å‰ç«¯çŸ¥è¯†ä½“ç³»æ€»ç»“ï¼ˆå·¥ç¨‹åŒ–ç¯‡ï¼‰ğŸ”¥ã€‹</a>ä¸­èŠè¿‡å¦‚ä½•å¼€å‘ä¸€ä¸ª babel æ’ä»¶</p><p>è¿™é‡Œç®€å•å›é¡¾ä¸€ä¸‹</p><h3 id="æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹" tabindex="-1">æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹ <a class="header-anchor" href="#æ’ä»¶çš„åŸºæœ¬æ ¼å¼ç¤ºä¾‹" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">   </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span></span>
<span class="line"><span style="color:#ABB2BF;">   </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">     </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#7F848E;font-style:italic;">// è®¾ç½®éœ€è¦èŒƒå›´çš„èŠ‚ç‚¹ç±»å‹</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#61AFEF;">CallExression</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">state</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">         </span><span style="color:#C678DD;">do</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">soming</span><span style="color:#ABB2BF;"> â€¦â€¦</span></span>
<span class="line"><span style="color:#ABB2BF;">       }</span></span>
<span class="line"><span style="color:#ABB2BF;">     }</span></span>
<span class="line"><span style="color:#ABB2BF;">   }</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">   </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> t </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.type</span></span>
<span class="line"><span style="color:#B392F0;">   </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">     visitor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">       </span><span style="color:#6B737C;">// è®¾ç½®éœ€è¦èŒƒå›´çš„èŠ‚ç‚¹ç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">       CallExression</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> (path</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> state) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">         </span><span style="color:#F97583;">do</span><span style="color:#B392F0;"> soming â€¦â€¦</span></span>
<span class="line"><span style="color:#B392F0;">       }</span></span>
<span class="line"><span style="color:#B392F0;">     }</span></span>
<span class="line"><span style="color:#B392F0;">   }</span></span>
<span class="line"><span style="color:#B392F0;"> }</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>1ï¼‰é€šè¿‡ <code>babel</code> æ‹¿åˆ° <code>types</code> å¯¹è±¡ï¼Œæ“ä½œ AST èŠ‚ç‚¹ï¼Œæ¯”å¦‚åˆ›å»ºã€æ ¡éªŒã€è½¬å˜ç­‰</p><p>2ï¼‰<code>visitor</code>ï¼šå®šä¹‰äº†ä¸€ä¸ªè®¿é—®è€…ï¼Œå¯ä»¥è®¾ç½®éœ€è¦è®¿é—®çš„èŠ‚ç‚¹ç±»å‹ï¼Œå½“è®¿é—®åˆ°ç›®æ ‡èŠ‚ç‚¹åï¼Œåšç›¸åº”çš„å¤„ç†æ¥å®ç°æ’ä»¶çš„åŠŸèƒ½</p><h3 id="å¯»æ‰¾-await-èŠ‚ç‚¹" tabindex="-1">å¯»æ‰¾ await èŠ‚ç‚¹ <a class="header-anchor" href="#å¯»æ‰¾-await-èŠ‚ç‚¹" aria-hidden="true">#</a></h3><p>å›åˆ°ä¸šåŠ¡éœ€æ±‚ï¼Œç°åœ¨éœ€è¦æ‰¾åˆ° await èŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡<code>AwaitExpression</code>è¡¨è¾¾å¼è·å–</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è®¾ç½®AwaitExpression</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#61AFEF;">AwaitExpression</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> t </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    visitor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è®¾ç½®AwaitExpression</span></span>
<span class="line"><span style="color:#B392F0;">      AwaitExpression(path) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> node </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.node;</span></span>
<span class="line"><span style="color:#B392F0;">      }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="å‘ä¸ŠæŸ¥æ‰¾-async-å‡½æ•°" tabindex="-1">å‘ä¸ŠæŸ¥æ‰¾ async å‡½æ•° <a class="header-anchor" href="#å‘ä¸ŠæŸ¥æ‰¾-async-å‡½æ•°" aria-hidden="true">#</a></h3><p>é€šè¿‡<code>findParent</code>æ–¹æ³•ï¼Œåœ¨çˆ¶èŠ‚ç‚¹ä¸­æœå¯» async èŠ‚ç‚¹</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// asyncèŠ‚ç‚¹çš„å±æ€§ä¸ºtrue</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">async</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// asyncèŠ‚ç‚¹çš„å±æ€§ä¸ºtrue</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent((p) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.async);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>è¿™é‡Œè¦æ³¨æ„ï¼Œasync å‡½æ•°åˆ†ä¸º 4 ç§æƒ…å†µï¼šå‡½æ•°å£°æ˜ ã€ç®­å¤´å‡½æ•° ã€å‡½æ•°è¡¨è¾¾å¼ ã€å‡½æ•°ä¸ºå¯¹è±¡çš„æ–¹æ³•</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 1ï¸âƒ£ï¼šå‡½æ•°å£°æ˜</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 2ï¸âƒ£ï¼šå‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 3ï¸âƒ£ï¼šç®­å¤´å‡½æ•°</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 4ï¸âƒ£ï¼šasyncå‡½æ•°å®šä¹‰åœ¨å¯¹è±¡ä¸­</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">obj</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// 1ï¸âƒ£ï¼šå‡½æ•°å£°æ˜</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// 2ï¸âƒ£ï¼šå‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> fn </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> () {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// 3ï¸âƒ£ï¼šç®­å¤´å‡½æ•°</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> fn </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">async</span><span style="color:#B392F0;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// 4ï¸âƒ£ï¼šasyncå‡½æ•°å®šä¹‰åœ¨å¯¹è±¡ä¸­</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">obj</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">async</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">  }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>éœ€è¦å¯¹è¿™å‡ ç§æƒ…å†µè¿›è¡Œåˆ†åˆ«åˆ¤æ–­</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è®¾ç½®AwaitExpression</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#61AFEF;">AwaitExpression</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// æŸ¥æ‰¾asyncå‡½æ•°çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">          (</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionDeclaration</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArrowFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isObjectMethod</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        );</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> t </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    visitor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è®¾ç½®AwaitExpression</span></span>
<span class="line"><span style="color:#B392F0;">      AwaitExpression(path) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> node </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.node;</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// æŸ¥æ‰¾asyncå‡½æ•°çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent(</span></span>
<span class="line"><span style="color:#B392F0;">          (p) </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.async </span><span style="color:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="color:#B392F0;">            (</span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionDeclaration() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isArrowFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isObjectMethod())</span></span>
<span class="line"><span style="color:#B392F0;">        );</span></span>
<span class="line"><span style="color:#B392F0;">      }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="åˆ©ç”¨-babel-template-ç”Ÿæˆ-try-catch-èŠ‚ç‚¹" tabindex="-1">åˆ©ç”¨ babel-template ç”Ÿæˆ try/catch èŠ‚ç‚¹ <a class="header-anchor" href="#åˆ©ç”¨-babel-template-ç”Ÿæˆ-try-catch-èŠ‚ç‚¹" aria-hidden="true">#</a></h3><p><a href="https://babel.docschina.org/docs/en/babel-template/" target="_blank" rel="noreferrer">babel-template</a>å¯ä»¥ç”¨ä»¥å­—ç¬¦ä¸²å½¢å¼çš„ä»£ç æ¥æ„å»º AST æ ‘èŠ‚ç‚¹ï¼Œå¿«é€Ÿä¼˜é›…å¼€å‘æ’ä»¶</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å¼•å…¥babel-template</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">template</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;babel-template&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®šä¹‰try/catchè¯­å¥æ¨¡æ¿</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryTemplate</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`</span></span>
<span class="line"><span style="color:#98C379;">try {</span></span>
<span class="line"><span style="color:#98C379;">} catch (e) {</span></span>
<span class="line"><span style="color:#98C379;">console.log(CatchErrorï¼še)</span></span>
<span class="line"><span style="color:#98C379;">}\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åˆ›å»ºæ¨¡æ¿</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">temp</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">template</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tryTemplate</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ç»™æ¨¡ç‰ˆå¢åŠ keyï¼Œæ·»åŠ console.logæ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// é€šè¿‡types.stringLiteralåˆ›å»ºå­—ç¬¦ä¸²å­—é¢é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">CatchError</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">types</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringLiteral</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Error&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// é€šè¿‡tempåˆ›å»ºtryè¯­å¥çš„ASTèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">temp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// å¼•å…¥babel-template</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">template</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require(</span><span style="color:#FFAB70;">&quot;babel-template&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// å®šä¹‰try/catchè¯­å¥æ¨¡æ¿</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryTemplate </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">\`</span></span>
<span class="line"><span style="color:#FFAB70;">try {</span></span>
<span class="line"><span style="color:#FFAB70;">} catch (e) {</span></span>
<span class="line"><span style="color:#FFAB70;">console.log(CatchErrorï¼še)</span></span>
<span class="line"><span style="color:#FFAB70;">}\`</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// åˆ›å»ºæ¨¡æ¿</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">temp</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> template(tryTemplate);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// ç»™æ¨¡ç‰ˆå¢åŠ keyï¼Œæ·»åŠ console.logæ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tempArgumentObj </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// é€šè¿‡types.stringLiteralåˆ›å»ºå­—ç¬¦ä¸²å­—é¢é‡</span></span>
<span class="line"><span style="color:#B392F0;">  CatchError</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">types</span><span style="color:#B392F0;">.stringLiteral(</span><span style="color:#FFAB70;">&quot;Error&quot;</span><span style="color:#B392F0;">)</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// é€šè¿‡tempåˆ›å»ºtryè¯­å¥çš„ASTèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryNode </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> temp(tempArgumentObj);</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="async-å‡½æ•°ä½“æ›¿æ¢æˆ-try-è¯­å¥" tabindex="-1">async å‡½æ•°ä½“æ›¿æ¢æˆ try è¯­å¥ <a class="header-anchor" href="#async-å‡½æ•°ä½“æ›¿æ¢æˆ-try-è¯­å¥" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#61AFEF;">AwaitExpression</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">          (</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionDeclaration</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArrowFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isObjectMethod</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">temp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// è·å–çˆ¶èŠ‚ç‚¹çš„å‡½æ•°ä½“body</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">info</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// å°†å‡½æ•°ä½“æ”¾åˆ°tryè¯­å¥çš„bodyä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">tryNode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">block</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(...</span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// å°†çˆ¶èŠ‚ç‚¹çš„bodyæ›¿æ¢æˆæ–°åˆ›å»ºçš„tryè¯­å¥</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> t </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    visitor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">      AwaitExpression(path) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> node </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.node;</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent(</span></span>
<span class="line"><span style="color:#B392F0;">          (p) </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.async </span><span style="color:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="color:#B392F0;">            (</span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionDeclaration() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isArrowFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isObjectMethod())</span></span>
<span class="line"><span style="color:#B392F0;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryNode </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> temp(tempArgumentObj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// è·å–çˆ¶èŠ‚ç‚¹çš„å‡½æ•°ä½“body</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> info </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.body;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// å°†å‡½æ•°ä½“æ”¾åˆ°tryè¯­å¥çš„bodyä¸­</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#79B8FF;">tryNode</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">block</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">body</span><span style="color:#B392F0;">.push(</span><span style="color:#F97583;">...</span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// å°†çˆ¶èŠ‚ç‚¹çš„bodyæ›¿æ¢æˆæ–°åˆ›å»ºçš„tryè¯­å¥</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [tryNode];</span></span>
<span class="line"><span style="color:#B392F0;">      }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>åˆ°è¿™é‡Œï¼Œæ’ä»¶çš„åŸºæœ¬ç»“æ„å·²ç»æˆå‹ï¼Œä½†è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œå¦‚æœå‡½æ•°å·²å­˜åœ¨ try/catchï¼Œè¯¥æ€ä¹ˆå¤„ç†åˆ¤æ–­å‘¢ï¼Ÿ</p><h3 id="è‹¥å‡½æ•°å·²å­˜åœ¨-try-catch-åˆ™ä¸å¤„ç†" tabindex="-1">è‹¥å‡½æ•°å·²å­˜åœ¨ try/catchï¼Œåˆ™ä¸å¤„ç† <a class="header-anchor" href="#è‹¥å‡½æ•°å·²å­˜åœ¨-try-catch-åˆ™ä¸å¤„ç†" aria-hidden="true">#</a></h3><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// ç¤ºä¾‹ä»£ç ï¼Œä¸å†æ·»åŠ try/catch</span></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fn</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">f</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// ç¤ºä¾‹ä»£ç ï¼Œä¸å†æ·»åŠ try/catch</span></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> fn() {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">try</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">await</span><span style="color:#B392F0;"> f();</span></span>
<span class="line"><span style="color:#B392F0;">  } </span><span style="color:#F97583;">catch</span><span style="color:#B392F0;"> (e) {</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.log(e);</span></span>
<span class="line"><span style="color:#B392F0;">  }</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>é€šè¿‡<code>isTryStatement</code>åˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨ try è¯­å¥</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#61AFEF;">AwaitExpression</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// åˆ¤æ–­çˆ¶è·¯å¾„ä¸­æ˜¯å¦å·²å­˜åœ¨tryè¯­å¥ï¼Œè‹¥å­˜åœ¨ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isTryStatement</span><span style="color:#ABB2BF;">())) {</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">          (</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">            (</span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionDeclaration</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArrowFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">              </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isObjectMethod</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">        );</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">temp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">info</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">tryNode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">block</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(...</span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> t </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    visitor</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">      AwaitExpression(path) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// åˆ¤æ–­çˆ¶è·¯å¾„ä¸­æ˜¯å¦å·²å­˜åœ¨tryè¯­å¥ï¼Œè‹¥å­˜åœ¨ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent((p) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isTryStatement())) {</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> node </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.node;</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent(</span></span>
<span class="line"><span style="color:#B392F0;">          (p) </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.async </span><span style="color:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="color:#B392F0;">            (</span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionDeclaration() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isArrowFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">              </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isObjectMethod())</span></span>
<span class="line"><span style="color:#B392F0;">        );</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryNode </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> temp(tempArgumentObj);</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> info </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.body;</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#79B8FF;">tryNode</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">block</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">body</span><span style="color:#B392F0;">.push(</span><span style="color:#F97583;">...</span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body);</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [tryNode];</span></span>
<span class="line"><span style="color:#B392F0;">      }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="æ·»åŠ æŠ¥é”™ä¿¡æ¯" tabindex="-1">æ·»åŠ æŠ¥é”™ä¿¡æ¯ <a class="header-anchor" href="#æ·»åŠ æŠ¥é”™ä¿¡æ¯" aria-hidden="true">#</a></h3><p>è·å–æŠ¥é”™æ—¶çš„æ–‡ä»¶è·¯å¾„ <code>filePath</code> å’Œæ–¹æ³•åç§° <code>funcName</code>ï¼Œæ–¹ä¾¿å¿«é€Ÿå®šä½é—®é¢˜</p><p><strong>è·å–æ–‡ä»¶è·¯å¾„</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// è·å–ç¼–è¯‘ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦‚ï¼šE:\\myapp\\src\\App.vue</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">filePath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">filename</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">opts</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">filename</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;unknown&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// è·å–ç¼–è¯‘ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦‚ï¼šE:\\myapp\\src\\App.vue</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">filePath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.filename </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">file</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">opts</span><span style="color:#B392F0;">.filename </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;unknown&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>è·å–æŠ¥é”™çš„æ–¹æ³•åç§°</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// å®šä¹‰æ–¹æ³•å</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è·å–asyncèŠ‚ç‚¹çš„typeç±»å‹</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 1ï¸âƒ£å‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// æƒ…å†µ1ï¼šæ™®é€šå‡½æ•°ï¼Œå¦‚const func = async function () {}</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// æƒ…å†µ2ï¼šç®­å¤´å‡½æ•°ï¼Œå¦‚const func = async () =&gt; {}</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;FunctionExpression&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ArrowFunctionExpression&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// ä½¿ç”¨path.getSibling(index)æ¥è·å¾—åŒçº§çš„idè·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">identifier</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSibling</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// è·å–funcæ–¹æ³•å</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">identifier</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">identifier</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">identifier</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 2ï¸âƒ£å‡½æ•°å£°æ˜ï¼Œå¦‚async function fn2() {}</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;FunctionDeclaration&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">id</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// 3ï¸âƒ£asyncå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚vueé¡¹ç›®ä¸­ï¼Œåœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•: methods: { async func() {} }</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ObjectMethod&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">key</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// è‹¥asyncNameä¸å­˜åœ¨ï¼Œé€šè¿‡argument.calleeè·å–å½“å‰æ‰§è¡Œå‡½æ•°çš„name</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">funcName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">argument</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">callee</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">argument</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">callee</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// å®šä¹‰æ–¹æ³•å</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// è·å–asyncèŠ‚ç‚¹çš„typeç±»å‹</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> type </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">switch</span><span style="color:#B392F0;"> (type) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 1ï¸âƒ£å‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// æƒ…å†µ1ï¼šæ™®é€šå‡½æ•°ï¼Œå¦‚const func = async function () {}</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// æƒ…å†µ2ï¼šç®­å¤´å‡½æ•°ï¼Œå¦‚const func = async () =&gt; {}</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FunctionExpression&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;ArrowFunctionExpression&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// ä½¿ç”¨path.getSibling(index)æ¥è·å¾—åŒçº§çš„idè·¯å¾„</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> identifier </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.getSibling(</span><span style="color:#FFAB70;">&quot;id&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#6B737C;">// è·å–funcæ–¹æ³•å</span></span>
<span class="line"><span style="color:#B392F0;">    asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> identifier </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">identifier</span><span style="color:#B392F0;">.node </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">identifier</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.name </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 2ï¸âƒ£å‡½æ•°å£°æ˜ï¼Œå¦‚async function fn2() {}</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FunctionDeclaration&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">    asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.id </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">id</span><span style="color:#B392F0;">.name) </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// 3ï¸âƒ£asyncå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚vueé¡¹ç›®ä¸­ï¼Œåœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•: methods: { async func() {} }</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;ObjectMethod&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">    asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">key</span><span style="color:#B392F0;">.name </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">    </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// è‹¥asyncNameä¸å­˜åœ¨ï¼Œé€šè¿‡argument.calleeè·å–å½“å‰æ‰§è¡Œå‡½æ•°çš„name</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> funcName </span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#B392F0;">  asyncName </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">argument</span><span style="color:#B392F0;">.callee </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">argument</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">callee</span><span style="color:#B392F0;">.name) </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="æ·»åŠ ç”¨æˆ·é€‰é¡¹" tabindex="-1">æ·»åŠ ç”¨æˆ·é€‰é¡¹ <a class="header-anchor" href="#æ·»åŠ ç”¨æˆ·é€‰é¡¹" aria-hidden="true">#</a></h3><p>ç”¨æˆ·å¼•å…¥æ’ä»¶æ—¶ï¼Œå¯ä»¥è®¾ç½®<code>exclude</code>ã€<code>include</code>ã€ <code>customLog</code>é€‰é¡¹</p><p><code>exclude</code>ï¼š è®¾ç½®éœ€è¦æ’é™¤çš„æ–‡ä»¶ï¼Œä¸å¯¹è¯¥æ–‡ä»¶è¿›è¡Œå¤„ç†</p><p><code>include</code>ï¼š è®¾ç½®éœ€è¦å¤„ç†çš„æ–‡ä»¶ï¼Œåªå¯¹è¯¥æ–‡ä»¶è¿›è¡Œå¤„ç†</p><p><code>customLog</code>ï¼š ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°ä¿¡æ¯</p><h3 id="æœ€ç»ˆä»£ç " tabindex="-1">æœ€ç»ˆä»£ç  <a class="header-anchor" href="#æœ€ç»ˆä»£ç " aria-hidden="true">#</a></h3><p><strong>å…¥å£æ–‡ä»¶ index.js</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// babel-template ç”¨äºå°†å­—ç¬¦ä¸²å½¢å¼çš„ä»£ç æ¥æ„å»ºASTæ ‘èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">template</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;babel-template&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">tryTemplate</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">catchConsole</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">mergeOptions</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">matchesFile</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;./util&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">babel</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// é€šè¿‡babel æ‹¿åˆ° types å¯¹è±¡ï¼Œæ“ä½œ AST èŠ‚ç‚¹ï¼Œæ¯”å¦‚åˆ›å»ºã€æ ¡éªŒã€è½¬å˜ç­‰</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">types</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">babel</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">types</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// visitorï¼šæ’ä»¶æ ¸å¿ƒå¯¹è±¡ï¼Œå®šä¹‰äº†æ’ä»¶çš„å·¥ä½œæµç¨‹ï¼Œå±äºè®¿é—®è€…æ¨¡å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">visitor</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">AwaitExpression</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// é€šè¿‡this.opts è·å–ç”¨æˆ·çš„é…ç½®</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">opts</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#C678DD;">typeof</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">opts</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">===</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;object&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#98C379;">&quot;[babel-plugin-await-add-trycatch]: options need to be an object.&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        );</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// åˆ¤æ–­çˆ¶è·¯å¾„ä¸­æ˜¯å¦å·²å­˜åœ¨tryè¯­å¥ï¼Œè‹¥å­˜åœ¨ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isTryStatement</span><span style="color:#ABB2BF;">())) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// åˆå¹¶æ’ä»¶çš„é€‰é¡¹</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">mergeOptions</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">opts</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è·å–ç¼–è¯‘ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦‚ï¼šE:\\myapp\\src\\App.vue</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">filePath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">filename</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">file</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">opts</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">filename</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;unknown&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// åœ¨æ’é™¤åˆ—è¡¨çš„æ–‡ä»¶ä¸ç¼–è¯‘</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">matchesFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">filePath</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// å¦‚æœè®¾ç½®äº†includeï¼Œåªç¼–è¯‘includeä¸­çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">include</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#61AFEF;">matchesFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">filePath</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// åœ¨çˆ¶è·¯å¾„èŠ‚ç‚¹ä¸­æŸ¥æ‰¾å£°æ˜ async å‡½æ•°çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// async å‡½æ•°åˆ†ä¸º4ç§æƒ…å†µï¼šå‡½æ•°å£°æ˜ || ç®­å¤´å‡½æ•° || å‡½æ•°è¡¨è¾¾å¼ || å¯¹è±¡çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">findParent</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        (</span><span style="color:#E06C75;font-style:italic;">p</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">          (</span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionDeclaration</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArrowFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isFunctionExpression</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">p</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isObjectMethod</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">      );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è·å–asyncçš„æ–¹æ³•å</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// 1ï¸âƒ£å‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// æƒ…å†µ1ï¼šæ™®é€šå‡½æ•°ï¼Œå¦‚const func = async function () {}</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// æƒ…å†µ2ï¼šç®­å¤´å‡½æ•°ï¼Œå¦‚const func = async () =&gt; {}</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;FunctionExpression&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ArrowFunctionExpression&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">// ä½¿ç”¨path.getSibling(index)æ¥è·å¾—åŒçº§çš„idè·¯å¾„</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">identifier</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getSibling</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;id&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#7F848E;font-style:italic;">// è·å–funcæ–¹æ³•å</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">identifier</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">identifier</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">node</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">identifier</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// 2ï¸âƒ£å‡½æ•°å£°æ˜ï¼Œå¦‚async function fn2() {}</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;FunctionDeclaration&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">id</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// 3ï¸âƒ£asyncå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚vueé¡¹ç›®ä¸­ï¼Œåœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•: methods: { async func() {} }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">case</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ObjectMethod&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">key</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è‹¥asyncNameä¸å­˜åœ¨ï¼Œé€šè¿‡argument.calleeè·å–å½“å‰æ‰§è¡Œå‡½æ•°çš„name</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">funcName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">asyncName</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">argument</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">callee</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">argument</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">callee</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">temp</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">template</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tryTemplate</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// ç»™æ¨¡ç‰ˆå¢åŠ keyï¼Œæ·»åŠ console.logæ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">// é€šè¿‡types.stringLiteralåˆ›å»ºå­—ç¬¦ä¸²å­—é¢é‡</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">CatchError</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">types</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">stringLiteral</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">          </span><span style="color:#61AFEF;">catchConsole</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">filePath</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">funcName</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">customLog</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        ),</span></span>
<span class="line"><span style="color:#ABB2BF;">      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// é€šè¿‡tempåˆ›å»ºtryè¯­å¥</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">temp</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">tempArgumentObj</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// è·å–asyncèŠ‚ç‚¹(çˆ¶èŠ‚ç‚¹)çš„å‡½æ•°ä½“</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">info</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">asyncPath</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">node</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// å°†çˆ¶èŠ‚ç‚¹åŸæ¥çš„å‡½æ•°ä½“æ”¾åˆ°tryè¯­å¥ä¸­</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">tryNode</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">block</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(...</span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;font-style:italic;">// å°†çˆ¶èŠ‚ç‚¹çš„å†…å®¹æ›¿æ¢æˆæ–°åˆ›å»ºçš„tryè¯­å¥</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">info</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">tryNode</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;babel-plugin-await-add-trycatch&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">visitor</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#6B737C;">// babel-template ç”¨äºå°†å­—ç¬¦ä¸²å½¢å¼çš„ä»£ç æ¥æ„å»ºASTæ ‘èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">template</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require(</span><span style="color:#FFAB70;">&quot;babel-template&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">tryTemplate</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">catchConsole</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">mergeOptions</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#79B8FF;">matchesFile</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">} </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require(</span><span style="color:#FFAB70;">&quot;./util&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">function</span><span style="color:#B392F0;"> (babel) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// é€šè¿‡babel æ‹¿åˆ° types å¯¹è±¡ï¼Œæ“ä½œ AST èŠ‚ç‚¹ï¼Œæ¯”å¦‚åˆ›å»ºã€æ ¡éªŒã€è½¬å˜ç­‰</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> types </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">babel</span><span style="color:#B392F0;">.types;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// visitorï¼šæ’ä»¶æ ¸å¿ƒå¯¹è±¡ï¼Œå®šä¹‰äº†æ’ä»¶çš„å·¥ä½œæµç¨‹ï¼Œå±äºè®¿é—®è€…æ¨¡å¼</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">visitor</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    AwaitExpression(path) {</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// é€šè¿‡this.opts è·å–ç”¨æˆ·çš„é…ç½®</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.opts </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!typeof</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.opts </span><span style="color:#F97583;">===</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;object&quot;</span><span style="color:#B392F0;">) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">console</span><span style="color:#B392F0;">.error(</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#FFAB70;">&quot;[babel-plugin-await-add-trycatch]: options need to be an object.&quot;</span></span>
<span class="line"><span style="color:#B392F0;">        );</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// åˆ¤æ–­çˆ¶è·¯å¾„ä¸­æ˜¯å¦å·²å­˜åœ¨tryè¯­å¥ï¼Œè‹¥å­˜åœ¨ç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent((p) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isTryStatement())) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">false</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// åˆå¹¶æ’ä»¶çš„é€‰é¡¹</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> mergeOptions(</span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.opts);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è·å–ç¼–è¯‘ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼Œå¦‚ï¼šE:\\myapp\\src\\App.vue</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">filePath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.filename </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">this</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">file</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">opts</span><span style="color:#B392F0;">.filename </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;unknown&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// åœ¨æ’é™¤åˆ—è¡¨çš„æ–‡ä»¶ä¸ç¼–è¯‘</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (matchesFile(</span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.exclude</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> filePath)) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// å¦‚æœè®¾ç½®äº†includeï¼Œåªç¼–è¯‘includeä¸­çš„æ–‡ä»¶</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">include</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">length</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">!</span><span style="color:#B392F0;">matchesFile(</span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.include</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> filePath)) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">return</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è·å–å½“å‰çš„awaitèŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> node </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.node;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// åœ¨çˆ¶è·¯å¾„èŠ‚ç‚¹ä¸­æŸ¥æ‰¾å£°æ˜ async å‡½æ•°çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// async å‡½æ•°åˆ†ä¸º4ç§æƒ…å†µï¼šå‡½æ•°å£°æ˜ || ç®­å¤´å‡½æ•° || å‡½æ•°è¡¨è¾¾å¼ || å¯¹è±¡çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">path</span><span style="color:#B392F0;">.findParent(</span></span>
<span class="line"><span style="color:#B392F0;">        (p) </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.async </span><span style="color:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="color:#B392F0;">          (</span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionDeclaration() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isArrowFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isFunctionExpression() </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#B392F0;">            </span><span style="color:#79B8FF;">p</span><span style="color:#B392F0;">.isObjectMethod())</span></span>
<span class="line"><span style="color:#B392F0;">      );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è·å–asyncçš„æ–¹æ³•å</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> type </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.type;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">switch</span><span style="color:#B392F0;"> (type) {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// 1ï¸âƒ£å‡½æ•°è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// æƒ…å†µ1ï¼šæ™®é€šå‡½æ•°ï¼Œå¦‚const func = async function () {}</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// æƒ…å†µ2ï¼šç®­å¤´å‡½æ•°ï¼Œå¦‚const func = async () =&gt; {}</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FunctionExpression&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;ArrowFunctionExpression&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">// ä½¿ç”¨path.getSibling(index)æ¥è·å¾—åŒçº§çš„idè·¯å¾„</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> identifier </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.getSibling(</span><span style="color:#FFAB70;">&quot;id&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#6B737C;">// è·å–funcæ–¹æ³•å</span></span>
<span class="line"><span style="color:#B392F0;">          asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> identifier </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">identifier</span><span style="color:#B392F0;">.node </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">identifier</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.name </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// 2ï¸âƒ£å‡½æ•°å£°æ˜ï¼Œå¦‚async function fn2() {}</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;FunctionDeclaration&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">          asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.id </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">id</span><span style="color:#B392F0;">.name) </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// 3ï¸âƒ£asyncå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚vueé¡¹ç›®ä¸­ï¼Œåœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•: methods: { async func() {} }</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#F97583;">case</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;ObjectMethod&quot;</span><span style="color:#B392F0;">:</span></span>
<span class="line"><span style="color:#B392F0;">          asyncName </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">key</span><span style="color:#B392F0;">.name </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">          </span><span style="color:#F97583;">break</span><span style="color:#B392F0;">;</span></span>
<span class="line"><span style="color:#B392F0;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è‹¥asyncNameä¸å­˜åœ¨ï¼Œé€šè¿‡argument.calleeè·å–å½“å‰æ‰§è¡Œå‡½æ•°çš„name</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> funcName </span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#B392F0;">        asyncName </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> (</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">argument</span><span style="color:#B392F0;">.callee </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">argument</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">callee</span><span style="color:#B392F0;">.name) </span><span style="color:#F97583;">||</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;&quot;</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">temp</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> template(tryTemplate);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// ç»™æ¨¡ç‰ˆå¢åŠ keyï¼Œæ·»åŠ console.logæ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tempArgumentObj </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">        </span><span style="color:#6B737C;">// é€šè¿‡types.stringLiteralåˆ›å»ºå­—ç¬¦ä¸²å­—é¢é‡</span></span>
<span class="line"><span style="color:#B392F0;">        CatchError</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">types</span><span style="color:#B392F0;">.stringLiteral(</span></span>
<span class="line"><span style="color:#B392F0;">          catchConsole(filePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> funcName</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.customLog)</span></span>
<span class="line"><span style="color:#B392F0;">        )</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// é€šè¿‡tempåˆ›å»ºtryè¯­å¥</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryNode </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> temp(tempArgumentObj);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// è·å–asyncèŠ‚ç‚¹(çˆ¶èŠ‚ç‚¹)çš„å‡½æ•°ä½“</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> info </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">asyncPath</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">node</span><span style="color:#B392F0;">.body;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// å°†çˆ¶èŠ‚ç‚¹åŸæ¥çš„å‡½æ•°ä½“æ”¾åˆ°tryè¯­å¥ä¸­</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">tryNode</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">block</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">body</span><span style="color:#B392F0;">.push(</span><span style="color:#F97583;">...</span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#6B737C;">// å°†çˆ¶èŠ‚ç‚¹çš„å†…å®¹æ›¿æ¢æˆæ–°åˆ›å»ºçš„tryè¯­å¥</span></span>
<span class="line"><span style="color:#B392F0;">      </span><span style="color:#79B8FF;">info</span><span style="color:#B392F0;">.body </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> [tryNode];</span></span>
<span class="line"><span style="color:#B392F0;">    }</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    name</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;babel-plugin-await-add-trycatch&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">    visitor</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  };</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br></div></div><p><strong>util.js</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code-dark"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">merge</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;deepmerge&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// å®šä¹‰tryè¯­å¥æ¨¡æ¿</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">tryTemplate</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`</span></span>
<span class="line"><span style="color:#98C379;">try {</span></span>
<span class="line"><span style="color:#98C379;">} catch (e) {</span></span>
<span class="line"><span style="color:#98C379;">console.log(CatchError,e)</span></span>
<span class="line"><span style="color:#98C379;">}\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * catchè¦æ‰“å°çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * @param {string} filePath - å½“å‰æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * @param {string} funcName - å½“å‰æ‰§è¡Œæ–¹æ³•çš„åç§°</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * @param {string} customLog - ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">catchConsole</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">filePath</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">funcName</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">customLog</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`</span></span>
<span class="line"><span style="color:#98C379;">filePath: </span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">filePath</span><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#98C379;">funcName: </span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">funcName</span><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">customLog</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">:\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// é»˜è®¤é…ç½®</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">defaultOptions</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">customLog</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Error&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;node_modules&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">: [],</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åˆ¤æ–­æ‰§è¡Œçš„fileæ–‡ä»¶ æ˜¯å¦åœ¨ exclude/include é€‰é¡¹å†…</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">matchesFile</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">list</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">filename</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">list</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">find</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">name</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">filename</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// åˆå¹¶é€‰é¡¹</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">mergeOptions</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">let</span><span style="color:#ABB2BF;"> { </span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;"> } </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">options</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;">) </span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">toArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">exclude</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">) </span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">toArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">include</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;">// ä½¿ç”¨mergeè¿›è¡Œåˆå¹¶</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">merge</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">all</span><span style="color:#ABB2BF;">([</span><span style="color:#E06C75;">defaultOptions</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">options</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">toArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Array</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">isArray</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> [</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">tryTemplate</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">catchConsole</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">defaultOptions</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">mergeOptions</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">matchesFile</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">toArray</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki min-dark vp-code-light"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">merge</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> require(</span><span style="color:#FFAB70;">&quot;deepmerge&quot;</span><span style="color:#B392F0;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// å®šä¹‰tryè¯­å¥æ¨¡æ¿</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> tryTemplate </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">\`</span></span>
<span class="line"><span style="color:#FFAB70;">try {</span></span>
<span class="line"><span style="color:#FFAB70;">} catch (e) {</span></span>
<span class="line"><span style="color:#FFAB70;">console.log(CatchError,e)</span></span>
<span class="line"><span style="color:#FFAB70;">}\`</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">/*</span></span>
<span class="line"><span style="color:#6B737C;"> * catchè¦æ‰“å°çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#6B737C;"> * @param {string} filePath - å½“å‰æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</span></span>
<span class="line"><span style="color:#6B737C;"> * @param {string} funcName - å½“å‰æ‰§è¡Œæ–¹æ³•çš„åç§°</span></span>
<span class="line"><span style="color:#6B737C;"> * @param {string} customLog - ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°ä¿¡æ¯</span></span>
<span class="line"><span style="color:#6B737C;"> */</span></span>
<span class="line"><span style="color:#F97583;">let</span><span style="color:#B392F0;"> catchConsole </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> (filePath</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> funcName</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> customLog) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">\`</span></span>
<span class="line"><span style="color:#FFAB70;">filePath: </span><span style="color:#F97583;">\${</span><span style="color:#B392F0;">filePath</span><span style="color:#F97583;">}</span></span>
<span class="line"><span style="color:#FFAB70;">funcName: </span><span style="color:#F97583;">\${</span><span style="color:#B392F0;">funcName</span><span style="color:#F97583;">}</span></span>
<span class="line"><span style="color:#F97583;">\${</span><span style="color:#B392F0;">customLog</span><span style="color:#F97583;">}</span><span style="color:#FFAB70;">:\`</span><span style="color:#B392F0;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// é»˜è®¤é…ç½®</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">defaultOptions</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  customLog</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> </span><span style="color:#FFAB70;">&quot;Error&quot;</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  exclude</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> [</span><span style="color:#FFAB70;">&quot;node_modules&quot;</span><span style="color:#B392F0;">]</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  include</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> []</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// åˆ¤æ–­æ‰§è¡Œçš„fileæ–‡ä»¶ æ˜¯å¦åœ¨ exclude/include é€‰é¡¹å†…</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> matchesFile(list</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> filename) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">list</span><span style="color:#B392F0;">.find((name) </span><span style="color:#F97583;">=&gt;</span><span style="color:#B392F0;"> name </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">filename</span><span style="color:#B392F0;">.includes(name));</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6B737C;">// åˆå¹¶é€‰é¡¹</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> mergeOptions(options) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">let</span><span style="color:#B392F0;"> { exclude</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> include } </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> options;</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (exclude) </span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.exclude </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> toArray(exclude);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">if</span><span style="color:#B392F0;"> (include) </span><span style="color:#79B8FF;">options</span><span style="color:#B392F0;">.include </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> toArray(include);</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#6B737C;">// ä½¿ç”¨mergeè¿›è¡Œåˆå¹¶</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">merge</span><span style="color:#B392F0;">.all([defaultOptions</span><span style="color:#BBBBBB;">,</span><span style="color:#B392F0;"> options]);</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> toArray(value) {</span></span>
<span class="line"><span style="color:#B392F0;">  </span><span style="color:#F97583;">return</span><span style="color:#B392F0;"> </span><span style="color:#79B8FF;">Array</span><span style="color:#B392F0;">.isArray(value) </span><span style="color:#F97583;">?</span><span style="color:#B392F0;"> value </span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> [value];</span></span>
<span class="line"><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">module</span><span style="color:#B392F0;">.</span><span style="color:#79B8FF;">exports</span><span style="color:#B392F0;"> </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> {</span></span>
<span class="line"><span style="color:#B392F0;">  tryTemplate</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  catchConsole</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  defaultOptions</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  mergeOptions</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  matchesFile</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">  toArray</span><span style="color:#BBBBBB;">,</span></span>
<span class="line"><span style="color:#B392F0;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p><a href="https://github.com/xy-sea/babel-plugin-await-add-trycatch" target="_blank" rel="noreferrer">æœ¬æ–‡ç« ä½œè€…çš„ github ä»“åº“</a></p>`,50),r=[e,c,t];function B(y,F,i,A,u,b){return l(),p("div",null,r)}const m=a(o,[["render",B]]);export{d as __pageData,m as default};
